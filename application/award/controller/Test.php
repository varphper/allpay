<?php
/**
 * Description: Created by PhpStorm.
 * User: varphper
 * Date: 2018/8/7
 * Time: 9:43
 * Email: varphper@gmail.com
 */

namespace app\award\controller;


use app\common\lib\Math;
use app\common\lib\Printer;
use Curl\Curl;
use think\facade\Env;
use think\Request;

class Test
{
    public function index()
    {
        $arr = [
            'id1' => 'id1$胜平负$胜$1.8',
            'id2' => ['id2$胜平负$胜$1.9', 'id2$胜平负$负$3.1'],
            'id3' => 'id3$胜平负$胜$1.1',
        ];
        $brr = array_values($arr);

        $math = (new Math())->jcCombination($brr, 2);
        dump($math);
    }

    public function run()
    {
        set_time_limit(0);
        $curl = new Curl();

        //大乐透
        dump($curl->get('http://tb.cd/index.php/award/dlt_award/calculateAward'));
        echo 1;
        echo "--";
    }

    public function decodePrintFile()
    {
        $string = "1D4C00001D5730021D50CBCB1B331A1B21011D21101B61011D50CBCB1B3322CCE5B2CAA1A4BEBAB2CA0A1B21001D21001B61011D50CBCB1B331ABEBAB2CAD7E3C7F2BBECBACFB9FDB9D80A3230323833362D3731353634392D3836373034372D31332030303535373137392035363633304243330A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0A1D50CBCB1B331E1B4501B9FDB9D8B7BDCABD2038783238202020202020202031B1B62020202020202020BACFBCC6203536D4AA200A1B45001B21001D21001B61001B21001D21001B6101B5DA31B3A1D6DCD2BB30303120CAA4C6BDB8BA20202020202020202020202020202020202020202020200AD6F7B6D33ACDBCC0ADB1F8B9A4B3A720567320BFCDB6D33ACAA5B1CBB5C3B1A4D4F3C4E1CCD8202020200A1B21001D21001B6101CAA440352E313030D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA32B3A1D6DCD2BB30303220CAA4C6BDB8BA20202020202020202020202020202020202020202020200AD6F7B6D33ACEDAB5C2C0D5D6A7C7E0C4EAB6D320567320BFCDB6D33AB5C7B2A9CBBC20202020202020200A1B21001D21001B6101C6BD40342E373530D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA33B3A1D6DCD2BB30303320C8C3C7F2CAA4C6BDB8BA2020C8C3C7F23AD6F72B3120202020202020200AD6F7B6D33AB0A3D2F2BBF4CEC2C7E0C4EAB6D320567320BFCDB6D33AC7B0BDF8D6AED3A52020202020200A1B21001D21001B6101C6BD40332E393530D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA34B3A1D6DCD2BB30303620C8C3C7F2CAA4C6BDB8BA2020C8C3C7F23AD6F72D3120202020202020200AD6F7B6D33ACEF7B2BCC2DEC4B7CEACC6E620567320BFCDB6D33AB2BCC2D7CCD8B8A3B5C22020202020200A1B21001D21001B6101CAA440332E303030D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA35B3A1D6DCD2BB30303720C8C3C7F2CAA4C6BDB8BA2020C8C3C7F23AD6F72D3120202020202020200AD6F7B6D33AC0B3CDF2CCD820567320BFCDB6D33AB1CFB6FBB0CDB6F5BEBABCBC202020202020202020200A1B21001D21001B6101C6BD40342E323030D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA36B3A1D6DCD2BB30313020C8C3C7F2CAA4C6BDB8BA2020C8C3C7F23AD6F72B3120202020202020200AD6F7B6D33AC0EFB0C2B0A2CEAC20567320BFCDB6D33AC0EFCBB9B1BEBEBABCBC202020202020202020200A1B21001D21001B6101C6BD40332E343530D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA37B3A1D6DCD2BB30313320C8C3C7F2CAA4C6BDB8BA2020C8C3C7F23AD6F72B3120202020202020200AD6F7B6D33AECABB7E720567320BFCDB6D33AB7C0D3F9D3EBD5FDD2E520202020202020202020202020200A1B21001D21001B6101C6BD40332E393530D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B6101B5DA38B3A1D6DCD2BB30313420CAA4C6BDB8BA20202020202020202020202020202020202020202020200AD6F7B6D33ACCFAC2B7B9A4B3A120567320BFCDB6D33ABEBABCBCBEE3C0D6B2BF202020202020202020200A1B21001D21001B6101CAA440332E323830D4AA20202020202020202020202020202020202020202020202020202020202020200A1B21001D21001B610128D1A1CFEEB9CCB6A8BDB1BDF0B6EECEAAC3BF31D4AACDB6D7A2B6D4D3A6B5C4BDB1BDF0B6EE292020200A1B21001D21001B6101B1BEC6B1D7EEB8DFBFC9C4DCB9CCB6A8BDB1BDF03A3230332C3030352E3433D4AA2020202020202020200A1B21001D21001B6101B5A5B1B6D7A2CAFD3A3678312A3238D7A23BB9B23238D7A22020202020202020202020202020202020200A202A20202A20202A202020202020202020202020202020202020202020202020202020202020202020200A202A20202A20202A202020202020202020202020202020202020202020202020202020202020202020200A202A20202A20202A202020202020202020202020202020202020202020202020202020202020202020200A202A20202A20202A202020202020202020202020202020202020202020202020202020202020202020200A202A20202A20202A202020202020202020202020202020202020202020202020202020202020202020200A1D50CBCB1B331A1B21001D21001B61012D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0AB8D0D0BBC4FACEAAB9ABD2E6CAC2D2B5B9B1CFD72031302E3038D4AA1B6401B4F3C0D6CDB8BDB1B3D836362E3835D2DAD4AA20B9ABD2E6CCE5B2CA20C0D6C9C6C8CBC9FA1B6401C2A6D0C7C7F8BCAAD0C7C2B7BCBCBCE0BED634B6B031C2A5D7F331BAC51B640131332D3031333534312D31303120202020202020202020202031382F31322F30332032313A35363A31340A1D50CBCB1B330C1B64011B1D7853300114061B1D785331051B1D785332031B1D785333021B1D7844200001021D32303238333637313536343938363730343731332030303535373137391B1D78501B1B1B1B1B";
        //$string = str_replace(" ","",$string);
        //echo $string;exit;
        $printer = new Printer();
        $data = $printer->decodePrintFile($string);
        file_put_contents('ticket.txt', $data);
        $content = file_get_contents('ticket.txt');
        $out = iconv('GB2312', 'UTF-8', $content);
        echo nl2br($out);
    }

    public function pcTest(Request $request)
    {
        $name = $request->param('data');
        return json(['device_id' => $name, 'device_password' => "123456"]);
    }

    public function ticketTrans()
    {
        $str = file_get_contents(Env::get('root_path') . 'public' . DIRECTORY_SEPARATOR . 'ticket.txt');
        $pattern = "/\w\w(\W+)?57 AB CC \w\w(\W+)?/";
        $tt = preg_replace($pattern,"",$str);
        file_put_contents(Env::get('root_path') . 'public' . DIRECTORY_SEPARATOR .'111ticket.txt',$tt);
    }

}